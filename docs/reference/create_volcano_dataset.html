<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create volcano dataset — create_volcano_dataset • HaDeX</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create volcano dataset — create_volcano_dataset" />
<meta property="og:description" content="Create volcano dataset" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">HaDeX</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/HaDeX.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/datafiles.html">Data processing</a>
    </li>
    <li>
      <a href="../articles/examples.html">Experimental examples</a>
    </li>
    <li>
      <a href="../articles/glossary.html">Glossary</a>
    </li>
    <li>
      <a href="../articles/hdxms.html">Basics of HDX-MS</a>
    </li>
    <li>
      <a href="../articles/usage.html">Code usage</a>
    </li>
    <li>
      <a href="../articles/visualization.html">Data visualization</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create volcano dataset</h1>
    
    <div class="hidden name"><code>create_volcano_dataset.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create volcano dataset</p>
    </div>

    <pre class="usage"><span class='fu'>create_volcano_dataset</span><span class='op'>(</span>
  <span class='va'>dat</span>,
  protein <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>[[</span><span class='st'>"Protein"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,
  state_1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>[[</span><span class='st'>"State"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,
  state_2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>[[</span><span class='st'>"State"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>,
  p_adjustment_method <span class='op'>=</span> <span class='st'>"none"</span>,
  confidence_level <span class='op'>=</span> <span class='fl'>0.98</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dat</th>
      <td><p>data imported by the <code><a href='read_hdx.html'>read_hdx</a></code> function.</p></td>
    </tr>
    <tr>
      <th>protein</th>
      <td><p>chosen protein.</p></td>
    </tr>
    <tr>
      <th>state_1</th>
      <td><p>biological state for chosen protein. From this state values
the second state values are subtracted to get the deuterium uptake difference.</p></td>
    </tr>
    <tr>
      <th>state_2</th>
      <td><p>biological state for chosen protein. This state values are 
subtracted from the first state values to get the deuterium uptake difference.</p></td>
    </tr>
    <tr>
      <th>p_adjustment_method</th>
      <td><p>method of adjustment P-values for multiple 
comparisons. Possible methods: "BH" (Benjamini &amp; Hochberg correction), 
"bonferroni" (Bonferroni correction) and "none" (default).</p></td>
    </tr>
    <tr>
      <th>confidence_level</th>
      <td><p>confidence level for the t-test.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a <code><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></code> object with calculated deuterium uptake difference, 
uncertainty, P-value and -log(P-value) for the peptides from the provided data.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The volcano plot shows the deuterium uptake difference in time 
for the peptides. This function prepares data for the plot.
For peptides in all of the time points of measurement (except for minimal
and maximal exchange control) the deuterium uptake difference between state_1
and state_2 is calculated, with its uncertainty (combined and propagated as
described in `Data processing` article). For each peptide in time point the 
P-value is calculated using unpaired t-test - the deuterium uptake difference
is calculated as the difference of measured masses in a given time point for two 
states. The tested hypothesis is that the mean masses for states from the 
replicates of the experiment are similar. The P-values indicates if the null
hypothesis can be rejected - rejection of the hypothesis means that the 
difference between states is statistically significant at provided confidence
level. The P-values can be adjusted using the provided method.
This plot is visible in GUI.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Hageman, T. S. &amp; Weis, D. D. Reliable Identification of Significant 
Differences in Differential Hydrogen Exchange-Mass Spectrometry Measurements 
Using a Hybrid Significance Testing Approach. Anal Chem 91, 8008–8016 (2019).</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='read_hdx.html'>read_hdx</a></code>
<code><a href='calculate_exp_masses_per_replicate.html'>calculate_exp_masses_per_replicate</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='read_hdx.html'>read_hdx</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span>package <span class='op'>=</span> <span class='st'>"HaDeX"</span>, <span class='st'>"HaDeX/data/KD_180110_CD160_HVEM.csv"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] ""</div><div class='input'><span class='va'>vol_dat</span> <span class='op'>&lt;-</span> <span class='fu'>create_volcano_dataset</span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: długość dłuszego obiektu nie jest wielokrotnością długości krótszego obiektu</span></div><div class='output co'>#&gt; <span class='warning'>Warning: długość dłuszego obiektu nie jest wielokrotnością długości krótszego obiektu</span></div><div class='output co'>#&gt; <span class='warning'>Warning: długość dłuszego obiektu nie jest wielokrotnością długości krótszego obiektu</span></div><div class='output co'>#&gt; <span class='warning'>Warning: długość dłuszego obiektu nie jest wielokrotnością długości krótszego obiektu</span></div><div class='output co'>#&gt; <span class='warning'>Warning: długość dłuszego obiektu nie jest wielokrotnością długości krótszego obiektu</span></div><div class='output co'>#&gt; <span class='warning'>Warning: długość dłuszego obiektu nie jest wielokrotnością długości krótszego obiektu</span></div><div class='output co'>#&gt; <span class='warning'>Warning: długość dłuszego obiektu nie jest wielokrotnością długości krótszego obiektu</span></div><div class='output co'>#&gt; <span class='warning'>Warning: długość dłuszego obiektu nie jest wielokrotnością długości krótszego obiektu</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>vol_dat</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         Sequence Start End Exposure       D_diff Uncertainty log_p_value
#&gt; 1 ARSQKSGIRLQGHF    88 101    0.167  0.288733032  0.04274585  6.37955170
#&gt; 2 ARSQKSGIRLQGHF    88 101    1.000  0.179737975  0.06185471  2.90257691
#&gt; 3 ARSQKSGIRLQGHF    88 101  120.000 -0.332431049  0.02093622 12.40741873
#&gt; 4 ARSQKSGIRLQGHF    88 101 1440.000  0.001092857  0.03873885  0.02165359
#&gt; 5 ARSQKSGIRLQGHF    88 101   25.000 -0.186360824  0.02384238  8.30704304
#&gt; 6 ARSQKSGIRLQGHF    88 101    5.000 -0.397528180  0.10068439  2.89209817
#&gt;        P_value
#&gt; 1 1.695883e-03
#&gt; 2 5.488161e-02
#&gt; 3 4.088147e-06
#&gt; 4 9.785792e-01
#&gt; 5 2.467727e-04
#&gt; 6 5.545973e-02</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Weronika Puchala, Michal Burdukiewicz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


