---
title: "hadexReport"
author: ""
date: ""
output:
  html_document:
    theme: united
    highlight: textmate
    toc: true
    toc_float: true
    number_sections: false
    df_print: paged
---

<style type="text/css">
span { 
      display: block;
      max-width: 100%;
      word-wrap: break-word;
    }
</style>



Report generated on `r Sys.time()` using the [HaDeX](http://github.com/hadexversum/HaDeX) R package.  

Detected input file: `r ifelse(is.null(input[["data_file"]][["name"]]), "none", input[["data_file"]][["name"]])`.  

MD5 hash of the input file: `r ifelse(is.null(input[["data_file"]][["name"]]), "none (example file)", tools::md5sum(as.character(input[["data_file"]][["datapath"]])))`.

# Summary

Protein name : `r as.character(unique(dat()[["Protein"]]))`

Protein sequence : <span>`r protein_sequence_colored()`</span>

Sequence length : `r input[["sequence_length"]]`

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}
knitr::kable(summary_data())
```

```{r, child="readmes/summary.md"}
```

<!--- OVERLAP DISTRIBUTION -->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_overlap_dist"]]){
  
  cat("## Overlap Distribution \n")
  
  stateOverlapDist()

}

```

<!--- OVERLAP DISTRIBUTION DATA -->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_overlap_dist_data"]]){

  cat("## Overlap Distribution Data \n")
  
  stateOverlapDist_data()
  
}

```

<!--- OVERLAP GRAPHICALLY -->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_overlap_graph"]]){
    
  cat("## Overlap Graphically \n")
    
  stateOverlap_out() 
  
}


```

<!--- OVERLAP GRAPHICALLY DATA -->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_overlap_graph_data"]]){
    
  cat("## Overlap Graphically Data \n")  
    
  stateOverlap_data()
  
}


```

<!--- COMPARISON PLOT --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_comparison_plot"]]){
    
  cat("## Comparison Plot \n")
  
  if(has_modifications()){
    cat("Supplied file contains modified peptids. Maximal exchange control cannot be applied.")
  } else{
    if(input[["time_100"]] == 99999){
      cat(paste0("Chosen control: ", input[["chosen_control"]], "."))
    } else{
      cat("No chosen control. \n")
    }
  }
  
  cp_out()
  
}

```

<!--- COMPARISON PLOT DATA --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_comparison_plot_data"]]){
    
  cat("## Comparison Plot Data \n")
  
  
if(has_modifications()){
    cat("Supplied file contains modified peptids. Maximal exchange control cannot be applied.")
  } else{
    if(input[["time_100"]] == 99999){
      cat(paste0("Chosen control: ", input[["chosen_control"]], "."))
    } else{
      cat("No chosen control. \n")
    }
  }
  
  comparison_plot_data()
    
}
```



<!--- WOODS PLOT --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_woods_plot"]]){
    
  cat("## Woods Plot \n")  
  
if(has_modifications()){
    cat("Supplied file contains modified peptids. Maximal exchange control cannot be applied.")
  } else{
    if(input[["time_100"]] == 99999){
      cat(paste0("Chosen control: ", input[["chosen_control"]], "."))
    } else{
      cat("No chosen control. \n")
    }
  }
  
  differential_plot_out()
    
}

```


<!--- WOODS PLOT DATA --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_woods_plot_data"]]){
    
  cat("## Woods Plot Data \n")
  
if(has_modifications()){
    cat("Supplied file contains modified peptids. Maximal exchange control cannot be applied.")
  } else{
    if(input[["time_100"]] == 99999){
      cat(paste0("Chosen control: ", input[["chosen_control"]], "."))
    } else{
      cat("No chosen control. \n")
    }
  }
  
  differential_plot_data()
    
}

```




<!--- KINETIC CHECK --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

kin_valid <- length(input[["peptide_list_data_rows_selected"]]) > 0


```

<!--- KINETIC PLOT --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_kin_plot"]]){
  
  cat("## Uptake curve \n")
  
  if (kin_valid) {
    
 if(has_modifications()){
    cat("Supplied file contains modified peptids. Maximal exchange control cannot be applied.")
  } else{
    if(input[["kin_time_100"]] == 99999){
      cat(paste0("Chosen control: ", input[["chosen_control"]], "."))
    } else{
      cat("No chosen control. \n")
    }
  }
    
    kp_out()

  } else {
    
    "Uptake curve cannot be shown - no peptides were selected"
    
  }
  
}

```


<!--- KINETIC PLOT DATA --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_kin_plot_data"]]){
  
  cat("## Uptake curve Data \n")
  
  if (kin_valid){
    
    
      if(has_modifications()){
        cat("Supplied file contains modified peptids. Maximal exchange control cannot be applied.")
      } else{
        if(input[["kin_time_100"]] == 99999){
          cat(paste0("Chosen control: ", input[["chosen_control"]], "."))
        } else{
          cat("No chosen control. \n")
        }
      }
    
    kin_plot_data()
    
    

  } else {
    
    "Uptake curve data cannot be shown - no peptides were selected"
    
  }

}

```







<!--- BUTTERFLY PLOT --->


```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_butterfly_plot"]]){
  
  cat("## Butterfly Plot \n")
  
  
  butterfly_plot_out()
  
}


```

<!--- BUTTERFLY PLOT DATA --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_butterfly_plot_data"]]){
  
  cat("## Butterfly Plot Data \n")
  
  butterfly_plot_data_out()
  
}

```

<!--- DIFFERENTIAL BUTTERFLY PLOT --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_butterfly_differential_plot"]]){
  
  cat("## Differential Butterfly Plot \n")
  
  butterfly_differential_plot_out()
  
}

```

<!--- DIFFERENTIAL BUTTERFLY PLOT DATA --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_butterfly_differential_plot_data"]]){
  
  cat("## Differential Butterfly Plot Data \n")
  
  butterfly_differential_plot_data_out()
  
}

```

<!--- CHICLET PLOT --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_chiclet_plot"]]){
  
  cat("## Chiclet Plot \n")
  
  chiclet_plot_out()
  
}

```

<!--- CHICLET PLOT DATA --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_chiclet_plot_data"]]){
  
  cat("## Chiclet Plot Data \n")
  
  chiclet_plot_data_out()
  
}

```

<!--- DIFFERENTIAL CHICLET PLOT --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_chiclet_differential_plot"]]){
  
  cat("## Differential Chiclet Plot \n")
  
  chiclet_differential_plot_out()
  
}

```

<!--- DIFFERENTIAL CHICLET PLOT DATA --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_chiclet_differential_plot_data"]]){
  
  cat("## Differential Chiclet Plot Data \n")
  
  chiclet_differential_plot_data_out()
  
}

```

<!--- VOLCANO PLOT --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_volcano_plot"]]){
  
  cat("## Volcano Plot \n")
  
  volcano_plot_out()
  
}

```

<!--- VOLCANO PLOT DATA --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_volcano_plot_data"]]){
  
  cat("## Volcano Plot Data \n")
  
  volcano_plot_data_out()
  
}

```







<!--- QUALITY CONTROL PLOT --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_quality_control_plot"]]){
  
  cat("## Quality Control Plot \n")
  
  cat("Quality control plot is based purely on experimental values.")
  
  qc_out()
  
}

```

<!--- QUALITY CONTROL PLOT DATA --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_quality_control_plot_data"]]){
  
  cat("## Quality Control Plot Data \n")
  
  cat("Quality control plot data is based purely on experimental values.")
  
  quality_control_plot_data_out()
  
}

```










<!--- REPLICATES CHECK --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

measures_valid <- length(input[["measures_sequence_rows_selected"]]) > 0


```


<!--- REPLICATE PLOTS --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_measures_plots"]]){
  
  cat("## Peptide Measurement Plot in selected timepoint \n")
  
  if(measures_valid){
    
    measures_plot_out()
    
  } else {
    
    "Measurement plot cannot be shown - no peptides were selected"
  }
  
}

```

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_measures_plots"]]){
  
  cat("## Peptide Mass Uptake Plot \n")
  
  if(measures_valid){
    
    mass_uptake_plot_out()
    
  } else {
    
    "Mass uptake plot cannot be shown - no peptides were selected"
  }
  
}

```


<!--- REPLICATE PLOTS DATA --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_replicate_plots_data"]]){
  
  cat("## Replicate Measurement Plot Data \n")
  
  if(rep_valid){
    
    replicates_plot_data_out()
    
    
  } else {
    
    "Replicate plot cannot be shown - no peptides were selected"
  }
  
}

```

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_replicate_plots_data"]]){
  
  cat("## Replicate Measured Charge Plot Data \n")
  
  if(rep_valid){
    
    replicate_charge_plot_data_out()
    
  } else {
    
    "Replicate plot cannot be shown - no peptides were selected"
  }
  
}

```


<!--- REPLICATE HISTOGRAMS AND DATA  --->

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_replicate_histograms"]]){
  
  cat("## Replicate Histogram for selected time point \n")
  
  replicates_histogram_out()
  
}
```

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_replicate_histograms_data"]]){
  
  cat("## Replicate Histogram for selected time point Data \n")
  
  replicates_histogram_data_out()
  
}
```

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_replicate_histograms"]]){
  
  cat("## Replicate Histogram for all time points \n")
  
  all_replicates_histogram_out()
  
}
```

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_replicate_histograms_data"]]){
  
  cat("## Replicate Histogram for all time points Data \n")
  
  all_replicates_histogram_data_out()
  
}
```


```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_replicate_histograms"]]){
  
  cat("## Replicate Histogram for time points \n")
  
  times_replicates_histogram_out()
  
}
```

```{r echo = FALSE, results = "asis", warning = FALSE, message = FALSE}

if (input[["export_replicate_histograms_data"]]){
  
  cat("## Replicate Histogram for time points Data \n")
  
  times_replicates_histogram_data_out()
  
}
```

# R Session

```{r, echo=FALSE}

pander::pander(sessionInfo())

```
